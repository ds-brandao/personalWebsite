<!DOCTYPE html>
<html>
<head>
  <title>Daniel Brandao</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <!-- Preconnect to external domains -->
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  
  <!-- Load critical CSS first -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
  
  <!-- Optimize font loading -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-color: #121212;
      --surface1-color: #1e1e1e;
      --surface2-color: #292929;
      --text-color: #f5f5f5;
      --text-secondary: #b3b3b3;
      --accent-color: #4f46e5;
      --accent-gradient: linear-gradient(135deg, #4f46e5, #818cf8);
      --accent-gradient-hover: linear-gradient(135deg, #4338ca, #6366f1);
      --card-bg: rgba(30, 30, 30, 0.7);
      --card-border: rgba(70, 70, 70, 0.3);
      --card-hover-shadow: 0 10px 25px -5px rgba(79, 70, 229, 0.2);
      --transition-speed: 0.3s;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
      overflow-x: hidden;
      min-height: 100vh;
      width: 100%;
      /* Enable hardware acceleration */
      -webkit-transform: translateZ(0);
      transform: translateZ(0);
    }

    /* Main Grid Layout - Modified for new asymmetrical layout with reduced center area */
    .main-layout {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      grid-template-rows: auto auto auto;
      grid-template-areas: 
        "articles about projects"
        "articles cycling projects"
        "articles contact projects";
      min-height: 100vh;
      width: 100%;
      position: relative;
      gap: 15px;
      padding: 15px;
      overflow-y: auto; /* Allow vertical scrolling */
      overflow-x: hidden;
    }

    /* Panel sizing and positioning */
    #articles {
      grid-area: articles;
      height: calc(100vh - 30px);
    }

    #about {
      grid-area: about;
      height: calc(38vh - 20px);
    }

    #projects {
      grid-area: projects;
      height: calc(100vh - 30px);
    }

    #contact {
      grid-area: contact;
      height: calc(38vh - 20px);
    }

    /* Center Cycling Text - Modified for smaller size */
    .center-circle {
      position: relative;
      grid-area: cycling;
      width: 100%;
      height: 85%; /* Reduced from 100% to 85% */
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 100;
      border: 2px solid transparent;
      background-image: radial-gradient(circle at center, rgba(30, 30, 30, 0.9) 0%, rgba(15, 15, 15, 0.9) 70%);
      box-shadow: 
        0 0 60px rgba(79, 70, 229, 0.2),
        inset 0 0 20px rgba(79, 70, 229, 0.1);
      border-radius: 12px;
      transition: all 0.5s ease;
      margin: auto; /* Added to center the reduced container */
      min-height: 180px; /* Minimum height to ensure content visibility */
    }

    .center-circle:hover {
      box-shadow: 0 0 80px rgba(79, 70, 229, 0.3);
      border: 2px solid rgba(79, 70, 229, 0.3);
    }

    .center-content {
      text-align: center;
      padding: 20px; /* Reduced padding from 30px to 20px */
    }

    .logo-text {
      display: none; /* Hide the DB:// logo text */
    }

    .typed-text-container {
      height: 60px; /* Reduced from 70px to 60px */
      display: flex;
      flex-direction: column;
      justify-content: center;
      margin-bottom: 15px; /* Reduced from 20px to 15px */
    }

    .hero-title {
      font-size: 22px;
      margin-bottom: 8px;
      font-weight: 600;
    }

    .hero-subtitle {
      font-size: 15px;
      color: var(--text-secondary);
      margin-bottom: 15px;
      font-weight: 400;
    }

    .cursor {
      display: inline-block;
      width: 8px;
      height: 20px;
      background-color: var(--accent-color);
      animation: blink 1s step-end infinite;
      vertical-align: middle;
      margin-left: 5px;
      border-radius: 2px;
    }

    @keyframes blink {
      from, to { opacity: 1; }
      50% { opacity: 0; }
    }

    /* Panel Styling - Removed blur effect */
    .panel {
      position: relative;
      transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease, border-color var(--transition-speed) ease;
      will-change: transform;
      padding: 25px;
      border-radius: 12px;
      border: 1px solid var(--card-border);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      background-color: var(--card-bg);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    .panel:hover {
      transform: scale(1.01);
      z-index: 99;
      border-color: rgba(79, 70, 229, 0.2);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
    }

    /* Panel title with icon */
    .panel-title {
      font-size: 20px;
      margin-bottom: 15px;
      color: var(--text-color);
      position: relative;
      display: flex;
      align-items: center;
      font-weight: 600;
    }

    .panel-title::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 40px;
      height: 3px;
      background: var(--accent-gradient);
      border-radius: 3px;
    }
    
    /* Add icon styling for panel titles */
    .panel-title i {
      margin-right: 10px;
      color: var(--accent-color);
      font-size: 18px;
    }

    .panel-content {
      overflow-y: auto;
      flex: 1;
      padding-right: 15px;
      font-size: 15px;
      color: var(--text-secondary);
      max-height: 100%; /* Ensure content doesn't overflow without scrolling */
    }

    .panel-content::-webkit-scrollbar {
      width: 4px;
    }

    .panel-content::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.1);
      border-radius: 4px;
    }

    .panel-content::-webkit-scrollbar-thumb {
      background: rgba(79, 70, 229, 0.5);
      border-radius: 4px;
    }

    /* Card styling */
    .card {
      background-color: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 8px;
      padding: 15px;
      position: relative;
      margin-bottom: 15px;
      font-size: 14px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: transform 0.15s ease, box-shadow 0.15s ease;
      will-change: transform;
    }

    .card:hover {
      box-shadow: var(--card-hover-shadow);
      transform: translateY(-3px);
      border-color: rgba(79, 70, 229, 0.3);
    }

    .card-header {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      border-bottom: 1px solid rgba(70, 70, 70, 0.2);
      padding-bottom: 10px;
    }

    .card-title {
      color: var(--text-color);
      font-size: 16px;
      font-weight: 500;
      margin-left: 10px;
    }

    .card-body {
      font-family: 'Inter', sans-serif;
      line-height: 1.5;
      color: var(--text-secondary);
    }

    .card-body a {
      color: var(--accent-color);
      text-decoration: none;
      font-weight: 500;
      transition: all 0.2s ease;
    }

    .card-body a:hover {
      text-decoration: underline;
    }

    .profile-highlight {
      color: var(--text-color);
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .profile-divider {
      border-color: rgba(70, 70, 70, 0.2);
      margin: 10px 0;
    }

    /* Projects Panel */
    .projects-grid {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .project-card {
      background-color: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 8px;
      overflow: hidden;
      transition: all 0.3s ease;
      width: 100%;
      font-size: 14px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      padding: 16px;
      cursor: pointer;
      position: relative;
    }

    .project-card:hover {
      transform: translateY(-3px);
      box-shadow: var(--card-hover-shadow);
      border-color: rgba(79, 70, 229, 0.3);
    }
    
    /* Add arrow indicator for clickable projects */
    .project-card::after {
      content: '\f105';
      font-family: 'Font Awesome 5 Free';
      font-weight: 900;
      position: absolute;
      bottom: 16px;
      right: 16px;
      color: var(--accent-color);
      opacity: 0.7;
      transition: transform 0.3s ease, opacity 0.3s ease;
    }
    
    .project-card:hover::after {
      transform: translateX(3px);
      opacity: 1;
    }

    .project-info {
      width: 100%;
    }

    .project-title {
      font-size: 16px;
      margin-bottom: 8px;
      color: var(--text-color);
      font-weight: 600;
    }

    .project-description {
      color: var(--text-secondary);
      margin-bottom: 12px;
      font-size: 14px;
      line-height: 1.5;
    }

    .project-links {
      display: flex;
      gap: 12px;
      margin-top: 12px;
    }

    .project-links a {
      color: var(--text-secondary);
      font-size: 13px;
      transition: color 0.3s ease;
      display: flex;
      align-items: center;
      gap: 6px;
      background-color: rgba(79, 70, 229, 0.1);
      padding: 5px 12px;
      border-radius: 4px;
    }

    .project-links a:hover {
      color: var(--accent-color);
      background-color: rgba(79, 70, 229, 0.15);
    }

    /* Blog Panel */
    .blog-grid {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .blog-post {
      border: 1px solid var(--card-border);
      border-radius: 8px;
      padding: 16px;
      background-color: var(--card-bg);
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      width: 100%;
      font-size: 14px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      position: relative;
    }

    .blog-post:hover {
      transform: translateY(-3px);
      box-shadow: var(--card-hover-shadow);
      border-color: rgba(79, 70, 229, 0.3);
    }

    .blog-post img {
      width: 100%;
      max-height: 120px;
      object-fit: cover;
      border-radius: 6px;
      margin-bottom: 12px;
    }

    .blog-post-title {
      font-size: 16px;
      font-weight: 600;
      margin-top: 5px;
      color: var(--text-color);
    }

    .blog-post-summary {
      margin-top: 8px;
      font-size: 14px;
      color: var(--text-secondary);
      flex-grow: 1;
    }

    .blog-post-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 12px;
      margin-bottom: 8px;
    }

    .blog-post-tag {
      display: inline-block;
      padding: 3px 10px;
      background-color: rgba(79, 70, 229, 0.1);
      border-radius: 12px;
      font-size: 10px;
      color: #a5a3f8;
      font-weight: 500;
      border: 1px solid rgba(79, 70, 229, 0.2);
    }

    .tag-security {
      background-color: rgba(225, 29, 72, 0.1);
      color: #fb7185;
      border-color: rgba(225, 29, 72, 0.2);
    }

    .tag-coding {
      background-color: rgba(34, 197, 94, 0.1);
      color: #86efac;
      border-color: rgba(34, 197, 94, 0.2);
    }

    .tag-ai {
      background-color: rgba(6, 182, 212, 0.1);
      color: #67e8f9;
      border-color: rgba(6, 182, 212, 0.2);
    }

    .tag-tutorial {
      background-color: rgba(245, 158, 11, 0.1);
      color: #fcd34d;
      border-color: rgba(245, 158, 11, 0.2);
    }

    .tag-project {
      background-color: rgba(168, 85, 247, 0.1);
      color: #d8b4fe;
      border-color: rgba(168, 85, 247, 0.2);
    }
    
    .blog-post-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    .blog-post a.read-more {
      display: inline-block;
      font-size: 11px;
      color: var(--accent-color);
      text-decoration: none;
      padding: 4px 8px;
      border-radius: 4px;
      background-color: rgba(79, 70, 229, 0.1);
      transition: all 0.2s ease;
    }

    .blog-post a.read-more:hover {
      background-color: rgba(79, 70, 229, 0.2);
    }

    /* Add arrow indicator for clickable articles */
    .blog-post::after {
      content: '\f105';
      font-family: 'Font Awesome 5 Free';
      font-weight: 900;
      position: absolute;
      bottom: 16px;
      right: 16px;
      color: var(--accent-color);
      opacity: 0.7;
      transition: transform 0.3s ease, opacity 0.3s ease;
    }
    
    .blog-post:hover::after {
      transform: translateX(3px);
      opacity: 1;
    }

    /* Contact Panel */
    .contact-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
      gap: 12px;
    }

    .contact-item {
      background-color: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 8px;
      padding: 15px;
      text-align: center;
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      position: relative;
    }

    .contact-item:hover {
      transform: translateY(-5px);
      box-shadow: var(--card-hover-shadow);
      border-color: rgba(79, 70, 229, 0.3);
    }

    .contact-icon {
      font-size: 20px;
      color: var(--accent-color);
      margin-bottom: 10px;
      background: rgba(79, 70, 229, 0.1);
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      margin: 0 auto 12px;
    }

    .contact-title {
      font-size: 14px;
      margin-bottom: 5px;
      font-weight: 600;
    }

    .contact-detail {
      color: var(--text-secondary);
      font-size: 12px;
    }

    .contact-detail a {
      color: var(--accent-color);
      text-decoration: none;
      font-weight: 500;
      transition: all 0.2s ease;
    }

    .contact-detail a:hover {
      text-decoration: underline;
    }

    /* Footer */
    .footer {
      text-align: center;
      padding: 10px;
      background-color: rgba(20, 20, 20, 0.8);
      font-size: 12px;
      color: var(--text-secondary);
      position: relative; /* Change from absolute to relative for scrollable layout */
      width: 100%;
      z-index: 10;
      backdrop-filter: blur(5px);
      border-top: 1px solid rgba(70, 70, 70, 0.2);
      margin-top: 20px; /* Add some space above footer */
    }

    .footer-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .social-links {
      display: flex;
      gap: 15px;
    }

    .social-links a {
      color: var(--text-secondary);
      font-size: 14px;
      transition: color 0.3s ease;
    }

    .social-links a:hover {
      color: var(--accent-color);
    }

    /* Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      display: none;
      z-index: 9999;
      overflow-y: auto;
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
      overscroll-behavior: contain;
    }

    .modal-content {
      background: var(--surface1-color);
      padding: 60px 32px 32px;
      width: 90%;
      max-width: 1000px;
      margin: 40px auto 40px;
      position: relative;
      min-height: auto;
      border-radius: 16px;
    }

    .modal-close {
      position: fixed;
      top: 24px;
      right: 24px;
      background: rgba(30, 30, 30, 0.9);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      cursor: pointer;
      font-weight: bold;
      font-size: 18px;
      color: var(--text-color);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10001;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(8px);
    }

    .modal-close:hover {
      background: rgba(79, 70, 229, 0.3);
      border-color: rgba(79, 70, 229, 0.4);
      transform: scale(1.05);
    }
    
    /* Modal body content */
    #modal-body {
      max-width: 100%;
      overflow-x: hidden;
      color: var(--text-color);
      font-size: 15px;
      line-height: 1.65;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }
    
    #modal-body > * {
      max-width: 100%;
    }
    
    #modal-body pre {
      overflow-x: auto;
      max-width: 100%;
      margin: 20px 0;
    }
    
    #modal-body img {
      max-width: 100%;
      height: auto;
    }
    
    /* More link styling */
    .more-link {
      text-align: center;
      margin-top: 10px;
    }
    
    .more-link a {
      color: var(--accent-color);
      font-size: 12px;
      text-decoration: none;
      padding: 5px 10px;
      border-radius: 4px;
      background-color: rgba(79, 70, 229, 0.1);
      transition: all 0.2s ease;
      display: inline-block;
    }
    
    .more-link a:hover {
      background-color: rgba(79, 70, 229, 0.2);
    }

    /* Responsive adjustments for new layout with reduced center area */
    @media (max-width: 1100px) {
      .main-layout {
        grid-template-columns: 1fr 1fr;
        grid-template-rows: auto auto auto;
        grid-template-areas: 
          "about projects"
          "cycling cycling"
          "articles contact";
        height: auto;
        min-height: 100vh;
        overflow-y: auto;
      }
      
      .center-circle {
        height: 180px; /* Reduced height on tablet */
        margin: 15px 0;
      }
      
      #articles, #about, #projects, #contact {
        height: auto;
        min-height: 300px;
        max-height: none; /* Remove any max-height limitations */
      }
    }

    /* Mobile-specific optimization */
    @media (max-width: 800px) {
      body {
        overflow-y: auto; /* Ensure body allows scrolling */
        font-size: 16px; /* Base font size for mobile */
      }
      
      .main-layout {
        grid-template-columns: 1fr;
        grid-template-rows: repeat(5, auto);
        grid-template-areas: 
          "cycling"
          "about"
          "projects"
          "articles"
          "contact";
        padding: 12px;
        gap: 12px;
        height: auto;
        min-height: 100vh;
      }
      
      /* Center Circle - mobile optimized */
      .center-circle {
        height: auto;
        min-height: 100px;
        padding: 12px 0;
        margin: 0 0 8px 0;
      }
      
      .typed-text-container {
        height: auto;
        margin-bottom: 8px;
      }
      
      .hero-title {
        font-size: 20px;
        margin-bottom: 5px;
      }
      
      .hero-subtitle {
        font-size: 14px;
        margin-bottom: 0;
      }
      
      .panel {
        min-height: auto;
        max-height: none;
        overflow: visible;
        margin-bottom: 12px;
        padding: 15px;
      }
      
      /* Fixed heights for scrollable panels */
      #articles, #projects {
        height: auto;
        max-height: 450px;
        overflow: hidden;
      }
      
      #articles .panel-content, 
      #projects .panel-content {
        max-height: 380px;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
      }
      
      /* Auto height for the other panels */
      #about, #contact {
        height: auto;
        min-height: auto;
        max-height: none;
      }
      
      .panel-title {
        font-size: 18px;
        margin-bottom: 12px;
      }
      
      .panel-content {
        font-size: 15px;
      }
      
      /* Cards for mobile */
      .blog-post, .project-card {
        padding: 12px;
        margin-bottom: 12px;
      }
      
      .blog-post img {
        max-height: 120px;
      }
      
      .blog-post-title {
        font-size: 16px;
      }
      
      .blog-post-summary {
        font-size: 14px;
      }
      
      /* Contact items */
      .contact-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
      }
      
      .contact-item {
        padding: 10px;
      }
      
      .contact-icon {
        width: 35px;
        height: 35px;
        font-size: 16px;
        margin-bottom: 8px;
      }
      
      .contact-title {
        font-size: 13px;
      }
      
      .contact-detail {
        font-size: 12px;
      }
      
      /* Visual indicator that content is scrollable */
      #articles .panel-content::after,
      #projects .panel-content::after {
        content: '';
        display: block;
        height: 20px;
        background: linear-gradient(to top, var(--card-bg) 0%, transparent 100%);
        position: sticky;
        bottom: 0;
        margin-top: -20px;
        pointer-events: none;
      }
      
      /* Mobile modal display */
      .modal-overlay {
        background: var(--surface1-color);
        padding: 0;
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
      }
      
      .modal-content {
        padding: 60px 20px 40px;
        width: 100%;
        margin: 0;
        background: var(--surface1-color);
        min-height: 100%;
        border-radius: 0;
        position: relative;
        display: block;
      }
      
      .modal-close {
        position: fixed;
        top: 15px;
        right: 15px;
        width: 40px;
        height: 40px;
        font-size: 20px;
        background: rgba(0, 0, 0, 0.8);
        z-index: 10001;
      }
      
      .modal-article-image {
        height: 150px;
        width: calc(100% + 40px);
        margin: -60px -20px 20px -20px;
        border-radius: 0;
        object-fit: cover;
      }
      
      /* Fix modal body content wrapping on mobile */
      #modal-body {
        width: 100%;
        padding: 0 0 40px 0;
        overflow-x: hidden;
        word-break: break-word;
        min-height: 100vh;
      }
      
      #modal-body > * {
        max-width: 100%;
        word-wrap: break-word;
        overflow-wrap: break-word;
      }
      
      #modal-body pre {
        overflow-x: auto;
        max-width: 100%;
        white-space: pre-wrap;
        word-wrap: break-word;
        font-size: 12px;
      }
      
      #modal-body code {
        word-break: break-word;
      }
      
      /* Adjust typography in modal for mobile */
      .modal-content h1 {
        font-size: 1.5em;
      }
      
      .modal-content h2 {
        font-size: 1.3em;
      }
      
      .modal-content h3, 
      .modal-content h4 {
        font-size: 1.1em;
      }
      
      .modal-content p, 
      .modal-content li {
        font-size: 0.95em;
        line-height: 1.5;
      }
      
      /* Ensure modal works properly on mobile */
      body.modal-open {
        overflow: hidden;
        position: fixed;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
      }
    }
    
    @media (max-width: 400px) {
      .modal-overlay {
        background: var(--surface1-color);
      }
      
      .modal-content {
        padding: 50px 15px 40px;
        margin: 0;
        width: 100%;
        min-height: 100%;
        background: var(--surface1-color);
      }
      
      #modal-body {
        padding-bottom: 60px;
        min-height: 100vh;
      }
      
      .modal-article-image {
        height: 180px;
        margin: -20px -12px 20px -12px;
      }
      
      .modal-close {
        top: 8px;
        right: 8px;
        width: 28px;
        height: 28px;
        font-size: 14px;
      }
    }

    /* Filter styling */
    .filter-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 15px;
    }

    .filter-tag {
      padding: 4px 10px;
      border-radius: 20px;
      background-color: rgba(30, 30, 30, 0.5);
      color: var(--text-secondary);
      font-size: 11px;
      border: 1px solid var(--card-border);
      cursor: pointer;
      transition: all 0.2s ease;
      font-weight: 500;
    }

    .filter-tag:hover {
      background-color: rgba(79, 70, 229, 0.1);
      color: var(--text-color);
    }

    .filter-tag.active {
      background-color: rgba(79, 70, 229, 0.2);
      color: var(--accent-color);
      border-color: rgba(79, 70, 229, 0.4);
    }

    /* Modal styling for article content */
    .modal-article-image {
      width: 100%;
      height: 220px;
      object-fit: cover;
      object-position: center 35%; /* Default position, can be overridden with inline style */
      border-radius: 12px;
      margin: -32px -32px 32px -32px;
      display: block;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    .modal-content img {
      max-width: 100%;
      border-radius: 6px;
      margin: 10px 0;
    }

    .modal-content h1 {
      font-size: 1.8em;
      font-weight: 600;
      margin-top: 0;
      margin-bottom: 0.8em;
      color: var(--text-color);
      line-height: 1.3;
    }

    .modal-content h2 {
      font-size: 1.4em;
      font-weight: 600;
      margin-top: 1.8em;
      margin-bottom: 0.6em;
      color: var(--text-color);
      line-height: 1.4;
    }
    
    .modal-content h3, 
    .modal-content h4 {
      font-size: 1.2em;
      font-weight: 600;
      margin-top: 1.5em;
      margin-bottom: 0.5em;
      color: var(--text-color);
      line-height: 1.4;
    }

    .modal-content p {
      margin-bottom: 1.2em;
      line-height: 1.6;
      font-size: 1em;
      color: var(--text-color);
    }

    .modal-content ul, 
    .modal-content ol {
      margin-bottom: 1.2em;
      padding-left: 1.8em;
      font-size: 1em;
      line-height: 1.6;
    }

    .modal-content li {
      margin-bottom: 0.3em;
    }

    .modal-content blockquote {
      border-left: 4px solid var(--accent-color);
      padding: 1em 1.5em;
      margin: 1.5em 0;
      background: rgba(79, 70, 229, 0.05);
      border-radius: 0 8px 8px 0;
      color: var(--text-secondary);
      font-style: italic;
      font-size: 1em;
    }

    .modal-content code {
      font-family: 'JetBrains Mono', monospace;
      background: rgba(30, 30, 30, 0.7);
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 0.95em;
      color: #e0e0e0;
      border: 1px solid rgba(79, 70, 229, 0.2);
    }

    .modal-content pre {
      background: rgba(20, 20, 20, 0.9);
      padding: 16px;
      border-radius: 8px;
      overflow-x: auto;
      margin: 16px 0;
      border: 1px solid rgba(79, 70, 229, 0.2);
      box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.3);
    }

    .modal-content pre code {
      background: transparent;
      padding: 0;
      font-size: 0.9em;
      color: #e0e0e0;
    }
    
    /* Modal article image */
    .modal-article-image {
      width: 100%;
      height: 200px;
      object-fit: cover;
      margin-bottom: 20px;
      border-radius: 0;
    }
    
    /* Mermaid diagram styling */
    .modal-content .mermaid {
      background: rgba(25, 25, 25, 0.9);
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
      text-align: center;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(79, 70, 229, 0.2);
      overflow-x: auto;
      color: #000000;
    }
    
    /* Responsive modal image adjustments */
    @media (min-width: 1024px) {
      .modal-article-image {
        height: 280px;
      }
      
      .modal-content {
        padding: 40px;
        max-width: 1100px;
      }
      
      .modal-content h1 {
        font-size: 2.2em;
      }
      
      .modal-content p {
        font-size: 1.05em;
        line-height: 1.7;
      }
    }
    
    @media (max-width: 600px) {
      .modal-content {
        padding: 20px;
        max-height: 88vh;
        width: 96%;
        margin: 20px auto;
      }
      
      .modal-close {
        top: 12px;
        right: 12px;
      }
      
      .modal-article-image {
        height: 180px;
        margin: -20px -20px 20px -20px;
      }
    }

    /* iPhone SE / Very small screens */
    @media (max-width: 380px) {
      body {
        font-size: 15px;
      }
      
      .main-layout {
        padding: 8px;
        gap: 8px;
      }
      
      .center-circle {
        min-height: 90px;
      }
      
      .hero-title {
        font-size: 18px;
      }
      
      .hero-subtitle {
        font-size: 13px;
      }
      
      .panel {
        padding: 12px;
      }
      
      #articles .panel-content, 
      #projects .panel-content {
        max-height: 320px;
      }
      
      .panel-title {
        font-size: 17px;
      }
      
      .panel-content {
        font-size: 14px;
      }
      
      .contact-icon {
        width: 30px;
        height: 30px;
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="main-layout">
    <!-- Center Circle -->
    <div class="center-circle">
      <div class="center-content">
        <div class="typed-text-container">
          <h1 class="hero-title">
            <span id="typed-text"></span>
            <span class="cursor"></span>
          </h1>
        </div>
        <p class="hero-subtitle">Cybersecurity Student | Developer | Problem Solver</p>
      </div>
    </div>

    <!-- Articles Panel -->
    <div id="articles" class="panel">
      <h2 class="panel-title"><i class="fas fa-pen-fancy"></i>Articles</h2>
      <div class="panel-content">
        <div class="filter-tags" id="category-filters">
          <button class="filter-tag active" data-filter="all">All</button>
          <!-- Category filters will be added here dynamically -->
        </div>
        <div class="blog-grid" id="blog-posts">
          <!-- Blog posts will be loaded here -->
        </div>
      </div>
    </div>

    <!-- About Panel -->
    <div id="about" class="panel">
      <h2 class="panel-title"><i class="fas fa-user"></i>About Me</h2>
      <div class="panel-content">
        <hr class="profile-divider">
        I am a Cybersecurity student at <a href="" id="college-link">Bellevue College</a>. 

        Currently, I have been exploring the many resources available to me and learning as much as I can as well as working on side-projects that seem to be never-ending...

        For fun, I enjoy listening to music (life is better with a soundtrack), get some <a href="" id="restaurant-link">Italian food</a>, and absolutely destroy my friends in Fifa.
      </div>
    </div>

    <!-- Projects Panel -->
    <div id="projects" class="panel">
      <h2 class="panel-title"><i class="fas fa-code-branch"></i>Projects</h2>
      <div class="panel-content">
        <div id="repo-list" class="projects-grid">
          <!-- GitHub repos will be loaded here -->
        </div>
      </div>
    </div>

    <!-- Contact Panel -->
    <div id="contact" class="panel">
      <h2 class="panel-title"><i class="fas fa-address-card"></i>Contact</h2>
      <div class="panel-content">
        <div class="contact-grid">
          <div class="contact-item">
            <div class="contact-icon">
              <i class="fas fa-envelope"></i>
            </div>
            <h3 class="contact-title">Email</h3>
            <p class="contact-detail">
              <a href="mailto:" id="email-link">Email me</a>
            </p>
          </div>
          <div class="contact-item">
            <div class="contact-icon">
              <i class="fab fa-linkedin"></i>
            </div>
            <h3 class="contact-title">LinkedIn</h3>
            <p class="contact-detail">
              <a href="" id="linkedin-link" target="_blank">Connect</a>
            </p>
          </div>
          <div class="contact-item">
            <div class="contact-icon">
              <i class="fab fa-github"></i>
            </div>
            <h3 class="contact-title">GitHub</h3>
            <p class="contact-detail">
              <a href="" id="github-profile-link" target="_blank">Follow</a>
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <div class="copyright">&copy; <span id="current-year"></span> Daniel Brandao</div>
        <div class="social-links">
          <a href="" id="footer-github-link" target="_blank"><i class="fab fa-github"></i></a>
          <a href="" id="footer-linkedin-link" target="_blank"><i class="fab fa-linkedin"></i></a>
          <a href="mailto:" id="footer-email-link"><i class="fas fa-envelope"></i></a>
        </div>
      </div>
    </footer>
  </div>

  <!-- Modal -->
  <div class="modal-overlay" id="modal-overlay">
    <div class="modal-content" id="modal-content">
      <button class="modal-close" id="modal-close"><i class="fas fa-times"></i></button>
      <div id="modal-body"></div>
    </div>
  </div>

  <!-- Defer non-critical scripts -->
  <script src="https://cdn.jsdelivr.net/npm/marked@4.3.0/marked.min.js" defer></script>
  <!-- Load mermaid only when needed -->
  <script>
    // Lazy load mermaid when a blog post is opened
    window.loadMermaid = function() {
      if (!window.mermaid && !window.mermaidLoading) {
        window.mermaidLoading = true;
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js';
        script.onload = function() {
          window.mermaidLoading = false;
          if (window.pendingMermaidInit) {
            window.pendingMermaidInit();
          }
        };
        document.head.appendChild(script);
      }
    };
  </script>
  <script>
    // Utility function: debounce for better mobile performance
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }
    
    // Current year for footer
    document.getElementById('current-year').textContent = new Date().getFullYear();
    
    // Typing animation for hero section
    const phrases = ["I'm Daniel Brandao", "I code security solutions", "I build secure systems", "I break things to fix them"];
    let currentPhraseIndex = 0;
    let currentCharIndex = 0;
    let isDeleting = false;
    let typingSpeed = 100;
    
    function typeText() {
      const currentPhrase = phrases[currentPhraseIndex];
      const typedTextElement = document.getElementById('typed-text');
      
      if (isDeleting) {
        typedTextElement.textContent = currentPhrase.substring(0, currentCharIndex - 1);
        currentCharIndex--;
        typingSpeed = 50;
      } else {
        typedTextElement.textContent = currentPhrase.substring(0, currentCharIndex + 1);
        currentCharIndex++;
        typingSpeed = 100;
      }
      
      if (!isDeleting && currentCharIndex === currentPhrase.length) {
        isDeleting = true;
        typingSpeed = 1500; // Pause at end of phrase
      } else if (isDeleting && currentCharIndex === 0) {
        isDeleting = false;
        currentPhraseIndex = (currentPhraseIndex + 1) % phrases.length;
        typingSpeed = 500; // Pause before starting new phrase
      }
      
      setTimeout(typeText, typingSpeed);
    }

    // Load config
    let config;
    async function loadConfig() {
      try {
        console.log('Loading configuration from config/config.json');
        const response = await fetch('config/config.json');
        
        if (!response.ok) {
          console.error('Config loading failed:', response.status, response.statusText);
          return;
        }
        
        config = await response.json();
        console.log('Config loaded successfully:', config);
        
        // Verify config has required data
        if (!config.tags) {
          console.warn('Missing tags configuration in config.json');
        }
        
        initializePage();
      } catch (error) {
        console.error('Error loading config:', error);
        // Add a user-visible error
        document.getElementById('blog-posts').innerHTML = `
          <div class="card">
            <div class="card-body">
              <p>Failed to load configuration. Please check the console for details.</p>
              <p>Error: ${error.message}</p>
            </div>
          </div>`;
      }
    }

    function initializePage() {
      console.log('Initializing page with config data');
      
      if (!config || !config.social || !config.social.github) {
        console.error('Invalid config structure - missing GitHub information');
        return;
      }
      
      // Update about section
      document.getElementById('college-link').href = config.personal.college.url;
      document.getElementById('college-link').textContent = config.personal.college.name;
      document.getElementById('restaurant-link').href = config.personal.favoriteRestaurant.url;
      document.getElementById('restaurant-link').textContent = config.personal.favoriteRestaurant.name;

      // Update contact information
      document.getElementById('email-link').href = `mailto:${config.social.email}`;
      document.getElementById('linkedin-link').href = config.social.linkedin;
      document.getElementById('github-profile-link').href = config.social.github.url;
      
      // Update footer links
      document.getElementById('footer-github-link').href = config.social.github.url;
      document.getElementById('footer-linkedin-link').href = config.social.linkedin;
      document.getElementById('footer-email-link').href = `mailto:${config.social.email}`;

      // After config is loaded, load blog posts and fetch GitHub repos
      console.log('Starting to load blog posts after config initialization');
      
      // Load content in parallel for better performance
      Promise.all([
        loadBlogPosts(),
        fetchRepos()
      ]).then(() => {
        console.log('All content loaded successfully');
      }).catch(err => {
        console.error('Error loading content:', err);
      });
    }

    // Performance optimizations
    const isMobile = window.matchMedia('(max-width: 800px)').matches;
    
    document.addEventListener('DOMContentLoaded', () => {
      // Load critical content first
      loadConfig();
      setupContactItems();
      
      // Delay non-critical animations on mobile
      if (!isMobile) {
        typeText();
      } else {
        // Simple static text on mobile
        document.getElementById('typed-text').textContent = "I'm Daniel Brandao";
      }
      
      // Remove global mermaid initialization - load only when needed
      /*try {
        mermaid.initialize({
          startOnLoad: true,
          theme: 'dark',
          securityLevel: 'loose',
          themeCSS: `
            .node rect, .node circle, .node ellipse, .node polygon, .node path {
              fill: #000000;
              stroke: rgba(79, 70, 229, 0.7);
            }
            .edgePath .path {
              stroke: rgba(79, 70, 229, 0.7);
            }
            .label {
              color: #000000 !important;
            }
            .label foreignObject {
              overflow: visible;
            }
            .nodeLabel {
              color: #000000 !important;
              font-weight: 600;
            }
            .node text {
              fill: #000000 !important;
            }
            .node foreignObject div {
              color: #000000 !important;
            }
          `
        });
        console.log('Mermaid initialized globally');
      } catch (mermaidErr) {
        console.error('Error initializing mermaid globally:', mermaidErr);
      }*/
      
      // Add debug query parameter check
      const urlParams = new URLSearchParams(window.location.search);
      window.debugMode = urlParams.has('debug');
      if (window.debugMode) {
        console.log('Debug mode enabled');
      }
    });

    // Fetch GitHub Repos with fallback to local JSON
    async function fetchRepos() {
      const repoList = document.getElementById('repo-list');
      
      // Show loading indicator
      repoList.innerHTML = `<div class="card">
        <div class="card-header">
          <h3 class="card-title">Loading GitHub Projects...</h3>
        </div>
        <div class="card-body">
          <p><i class="fas fa-spinner fa-spin"></i> Fetching projects from GitHub...</p>
        </div>
      </div>`;
      
      try {
        if (!config || !config.social || !config.social.github || !config.social.github.username) {
          throw new Error('GitHub username not configured');
        }
        
        const username = config.social.github.username;
        console.log('Fetching repositories for GitHub user:', username);
        
        // Try first with our nginx proxy to avoid CORS issues
        try {
          console.log('Using local proxy for GitHub API');
          const response = await fetch(`/github-api/users/${username}/repos?sort=updated&per_page=10&direction=desc`, {
            cache: 'no-cache'
          });
          
          if (!response.ok) {
            console.error(`GitHub API via proxy error: ${response.status} ${response.statusText}`);
            throw new Error('Proxy request failed');
          }
          
          const repos = await response.json();
          
          if (repos && repos.length > 0) {
            console.log('Successfully fetched GitHub repos via proxy:', repos.length);
            displayRepos(repos, repoList, config.social.github.url);
            return; // Early return if successful
          }
          console.warn('No repositories found via proxy, trying direct API');
        } catch (proxyError) {
          console.warn('Proxy request failed, falling back to direct API:', proxyError.message);
        }
        
        // Fall back to direct GitHub API request if proxy fails
        const fetchPromise = fetch(`https://api.github.com/users/${username}/repos?sort=updated&per_page=10&direction=desc`, {
          headers: {
            'Accept': 'application/vnd.github.v3+json'
          },
          cache: 'no-cache'
        });
        
        // Set a shorter timeout to fail faster
        const timeoutPromise = new Promise((_, reject) => 
          setTimeout(() => reject(new Error('GitHub API request timed out')), 3000)
        );
        
        // Race between the fetch and the timeout
        const response = await Promise.race([fetchPromise, timeoutPromise]);
        
        if (!response.ok) {
          // Log detailed error info
          console.error(`GitHub API error: ${response.status} ${response.statusText}`);
          
          if (response.status === 403) {
            const rateLimitRemaining = response.headers.get('X-RateLimit-Remaining');
            if (rateLimitRemaining === '0') {
              console.error('GitHub API rate limit exceeded');
              throw new Error('GitHub API rate limit exceeded. Try again later.');
            }
          }
          
          if (response.status === 404) {
            console.error('GitHub user not found');
            throw new Error(`GitHub user "${username}" not found`);
          }
          
          throw new Error(`GitHub API returned ${response.status}: ${response.statusText}`);
        }
        
        const repos = await response.json();
        console.log('Successfully fetched GitHub repos:', repos.length);
        
        if (!repos || repos.length === 0) {
          console.log('No public repositories found, using fallback');
          throw new Error('No public repositories found');
        }
        
        // Display the repositories
        displayRepos(repos, repoList, config.social.github.url);
        
      } catch (error) {
        console.error('Error fetching from GitHub API:', error.message);
        
        // Attempt to load from local fallback file
        try {
          console.log('Falling back to local projects file');
          const response = await fetch('config/projects.json');
          
          if (!response.ok) {
            throw new Error(`Local projects file returned ${response.status}`);
          }
          
          const repos = await response.json();
          
          if (!repos || repos.length === 0) {
            throw new Error('No projects in local file');
          }
          
          // Display a notice that we're using cached data
          displayRepos(repos, repoList, config.social.github.url, true);
          
        } catch (fallbackError) {
          console.error('Fallback error:', fallbackError.message);
          // Both GitHub API and local fallback failed
          let errorMessage = `
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">GitHub Projects</h3>
              </div>
              <div class="card-body">
                <p>Unable to retrieve projects. Please check your connection and try again.</p>
                <p>You can view my projects directly on 
                  <a href="${config?.social?.github?.url || 'https://github.com/ds-brandao'}" target="_blank">GitHub <i class="fas fa-external-link-alt"></i></a>
                </p>
              </div>
            </div>`;
            
          // Add debug information if debug mode is enabled
          if (window.debugMode) {
            errorMessage += `
              <div class="card" style="border-color: rgba(245, 158, 11, 0.5); margin-top: 15px;">
                <div class="card-header" style="border-bottom-color: rgba(245, 158, 11, 0.3);">
                  <h3 class="card-title"><i class="fas fa-bug" style="color: #f59e0b;"></i> Debug Information</h3>
                </div>
                <div class="card-body">
                  <p><strong>GitHub Error:</strong> ${error.message}</p>
                  <p><strong>Fallback Error:</strong> ${fallbackError.message}</p>
                  <p><strong>GitHub Username:</strong> ${config?.social?.github?.username || 'Not configured'}</p>
                  <p><small>This debug information is only visible because the URL has the '?debug' parameter.</small></p>
                </div>
              </div>`;
          }
          
          repoList.innerHTML = errorMessage;
        }
      }
    }

    // Helper function to display repositories
    function displayRepos(repos, repoList, githubUrl, isFallback = false) {
      repoList.innerHTML = ''; // Clear any existing content
      
      // If using fallback data, show an indicator
      if (isFallback) {
        const fallbackIndicator = document.createElement('div');
        fallbackIndicator.className = 'card';
        fallbackIndicator.style.marginBottom = '15px';
        fallbackIndicator.style.padding = '10px';
        fallbackIndicator.style.backgroundColor = 'rgba(245, 158, 11, 0.1)';
        fallbackIndicator.style.border = '1px solid rgba(245, 158, 11, 0.3)';
        fallbackIndicator.innerHTML = `
          <div class="card-body" style="padding: 0;">
            <p style="margin: 0;"><i class="fas fa-exclamation-triangle" style="color: #f59e0b;"></i> 
            Showing cached project data. Couldn't connect to GitHub.</p>
          </div>
        `;
        repoList.appendChild(fallbackIndicator);
      }
      
      // Display all repos in a scrollable container
      repos.forEach(repo => {
        const repoItem = document.createElement('div');
        repoItem.className = 'project-card';
        repoItem.setAttribute('role', 'button');
        repoItem.setAttribute('aria-label', `View project: ${repo.name}`);
        repoItem.setAttribute('tabindex', '0');
        
        // Make entire card clickable to go to repository
        repoItem.addEventListener('click', (e) => {
          // Only trigger if not clicking on an actual link inside the card
          if (!e.target.closest('a')) {
            window.open(repo.html_url, '_blank');
          }
        });
        
        // Add keyboard navigation
        repoItem.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            if (!e.target.closest('a')) {
              e.preventDefault();
              window.open(repo.html_url, '_blank');
            }
          }
        });
        
        let repoContent = `
          <div class="project-info">
            <h3 class="project-title">${repo.name}</h3>
            <p class="project-description">${repo.description || 'No description available'}</p>
            <div class="project-links">
              <a href="${repo.html_url}" target="_blank"><i class="fab fa-github"></i> Repository</a>
              ${repo.homepage ? `<a href="${repo.homepage}" target="_blank"><i class="fas fa-external-link-alt"></i> Demo</a>` : ''}
            </div>
          </div>
        `;
        
        repoItem.innerHTML = repoContent;
        repoList.appendChild(repoItem);
      });
    }

    // Load blog posts
    async function loadBlogPosts() {
      try {
        console.log('Starting to load blog posts...');
        // Add cache-busting parameter to avoid browser caching
        const timestamp = new Date().getTime();
        console.log('Fetching articles from config/articles.json');
        const response = await fetch(`config/articles.json?_=${timestamp}`);
        
        if (!response.ok) {
          console.error(`Articles fetch failed with status: ${response.status}`);
          throw new Error(`Failed to fetch articles: ${response.statusText}`);
        }
        
        const posts = await response.json();
        console.log('Loaded blog posts:', posts);
        const blogContainer = document.getElementById('blog-posts');
        const categoryFilters = document.getElementById('category-filters');
        
        // Check if blog container exists
        if (!blogContainer) {
          console.error('Blog container element not found!');
          return;
        }
        
        // Clear existing posts
        blogContainer.innerHTML = '';
        console.log('Cleared existing posts from container');
        
        // Clear existing filter buttons except 'All'
        const existingFilterButtons = categoryFilters.querySelectorAll('.filter-tag:not([data-filter="all"])');
        existingFilterButtons.forEach(btn => btn.remove());

        // Use predefined tags from config instead of extracting from posts
        if (config && config.tags) {
          console.log('Adding filter buttons for tags:', Object.keys(config.tags));
          // Add filter buttons for each predefined tag
          Object.keys(config.tags).forEach(tagName => {
            const filterBtn = document.createElement('button');
            filterBtn.className = 'filter-tag';
            filterBtn.setAttribute('data-filter', tagName.toLowerCase());
            filterBtn.textContent = tagName;
            categoryFilters.appendChild(filterBtn);
          });
        } else {
          console.warn('No tags found in config or config not loaded yet. Current config:', config);
        }
        
        // Create a map to store all posts by their elements
        const allPostElements = [];
        
        // Check if we have posts
        if (!posts || posts.length === 0) {
          console.warn('No blog posts found in articles.json');
          blogContainer.innerHTML = '<div class="card"><div class="card-body">No articles found.</div></div>';
          return;
        }
        
        console.log(`Processing ${posts.length} blog posts`);
        
        // Load all posts
        posts.forEach((post, index) => {
          console.log(`Creating element for post ${index + 1}: ${post.title}`);
          const article = document.createElement('div');
          article.className = 'blog-post';
          article.setAttribute('role', 'button');
          article.setAttribute('aria-label', `Read article: ${post.title}`);
          article.setAttribute('tabindex', '0');
          
          // Direct click handling for faster response
          article.addEventListener('click', (e) => {
            e.preventDefault();
            showFullPost(post.markdown, post.image, post.title, post.objectPosition);
          });
          
          article.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              showFullPost(post.markdown, post.image, post.title, post.objectPosition);
            }
          });
          
          // Filter and validate tags against predefined tags
          const validTags = [];
          if (post.tags && post.tags.length > 0 && config && config.tags) {
            post.tags.forEach(tag => {
              if (config.tags[tag]) {
                validTags.push(tag);
              } else {
                console.warn(`Post "${post.title}" has invalid tag: ${tag}`);
              }
            });
            
            // Set data-categories for filtering
            if (validTags.length > 0) {
              article.setAttribute('data-categories', validTags.map(tag => tag.toLowerCase()).join(' '));
            }
          }
          
          if (post.image) {
            const image = document.createElement('img');
            image.loading = 'lazy';
            image.decoding = 'async';
            // Use smaller images on mobile
            if (isMobile && post.imageMobile) {
              image.src = post.imageMobile;
            } else {
              image.src = post.image;
            }
            image.alt = post.title;
            // Apply object-position if specified in the post data
            if (post.objectPosition) {
              image.style.objectPosition = post.objectPosition;
            }
            // Add error handler for images
            image.onerror = function() {
              console.error(`Image not found: ${post.image}`);
              this.src = 'https://via.placeholder.com/300x150?text=Image+Not+Found';
            };
            article.appendChild(image);
          } else {
            console.warn(`Post "${post.title}" has no image`);
          }
          
          // Add tags using the predefined styles from config
          if (validTags.length > 0) {
            const tagsContainer = document.createElement('div');
            tagsContainer.className = 'blog-post-tags';
            
            validTags.forEach(tag => {
              const tagElement = document.createElement('span');
              // Use the color class from config
              const colorClass = config.tags[tag].color || tag.toLowerCase();
              tagElement.className = `blog-post-tag tag-${colorClass}`;
              tagElement.textContent = tag;
              // Add the description as a tooltip
              if (config.tags[tag].description) {
                tagElement.title = config.tags[tag].description;
              }
              tagsContainer.appendChild(tagElement);
            });
            
            article.appendChild(tagsContainer);
          }

          const title = document.createElement('div');
          title.className = 'blog-post-title';
          title.textContent = post.title;

          const summary = document.createElement('div');
          summary.className = 'blog-post-summary';
          summary.textContent = post.summary;

          const footer = document.createElement('div');
          footer.className = 'blog-post-footer';

          const readMoreIndicator = document.createElement('div');
          readMoreIndicator.className = 'read-more-indicator';
          readMoreIndicator.textContent = 'Click to read';
          readMoreIndicator.style.fontSize = '11px';
          readMoreIndicator.style.color = 'var(--text-secondary)';
          readMoreIndicator.style.marginLeft = 'auto';
          
          footer.appendChild(readMoreIndicator);
          
          article.appendChild(title);
          article.appendChild(summary);
          article.appendChild(footer);

          blogContainer.appendChild(article);
          allPostElements.push(article);
          console.log(`Added post ${index + 1} to container`);
        });
        
        console.log('Setting up filter button event handlers');
        // Attach click handlers to filter buttons
        const filterButtons = categoryFilters.querySelectorAll('.filter-tag');
        filterButtons.forEach(btn => {
          btn.addEventListener('click', () => {
            const filter = btn.getAttribute('data-filter');
            console.log(`Toggle filter: ${filter}`);
            
            // Handle the "All" filter specially
            if (filter === 'all') {
              // Deactivate all other filters when "All" is clicked
              filterButtons.forEach(b => {
                if (b.getAttribute('data-filter') !== 'all') {
                  b.classList.remove('active');
                }
              });
              btn.classList.add('active');
            } else {
              // For other filters, toggle their active state
              btn.classList.toggle('active');
              
              // If we're activating a filter, deactivate the "All" filter
              if (btn.classList.contains('active')) {
                const allFilter = categoryFilters.querySelector('.filter-tag[data-filter="all"]');
                if (allFilter) {
                  allFilter.classList.remove('active');
                }
              }
              
              // If no filters are active, activate the "All" filter
              const activeFilters = categoryFilters.querySelectorAll('.filter-tag.active');
              if (activeFilters.length === 0) {
                const allFilter = categoryFilters.querySelector('.filter-tag[data-filter="all"]');
                if (allFilter) {
                  allFilter.classList.add('active');
                }
              }
            }
            
            // Get all active filters
            const activeFilters = Array.from(categoryFilters.querySelectorAll('.filter-tag.active'))
              .map(el => el.getAttribute('data-filter'));
            
            console.log(`Active filters: ${activeFilters.join(', ')}`);
            
            // Apply filters using OR logic (show if matches ANY selected filter)
            if (activeFilters.includes('all')) {
              // If "All" is active, show everything
              allPostElements.forEach(post => {
                post.style.display = 'flex';
              });
            } else {
              // Show posts that match ANY of the selected filters
              allPostElements.forEach(post => {
                const categories = post.getAttribute('data-categories') || '';
                const shouldShow = activeFilters.some(filter => categories.includes(filter));
                post.style.display = shouldShow ? 'flex' : 'none';
              });
            }
          });
        });
        
        console.log('Blog posts loading completed successfully');
      } catch (e) {
        console.error('Error loading blog posts:', e);
        const blogContainer = document.getElementById('blog-posts');
        if (blogContainer) {
          blogContainer.innerHTML = `
            <div class="card">
              <div class="card-body">
                <p>Error loading articles: ${e.message}</p>
                <p>Please check the console for more details.</p>
              </div>
            </div>`;
        }
      }
      
      // Return a resolved promise for chaining
      return Promise.resolve();
    }

    // Modal functionality
    const modalOverlay = document.getElementById('modal-overlay');
    const modalClose = document.getElementById('modal-close');
    const modalBody = document.getElementById('modal-body');
    const modalContent = document.getElementById('modal-content');

    // Close modal when clicking the X button
    modalClose.addEventListener('click', closeModal);
    
    // Close modal when clicking outside the content area
    modalOverlay.addEventListener('click', (e) => {
      if (!modalContent.contains(e.target)) {
        closeModal();
      }
    });
    
    // Close modal when pressing the Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && modalOverlay.style.display === 'flex') {
        closeModal();
      }
    });
    
    function closeModal() {
      modalOverlay.style.display = 'none';
      modalBody.innerHTML = '';
      
      // Get stored scroll position
      const scrollY = document.body.style.top;
      
      // Remove modal class and restore scroll
      document.body.classList.remove('modal-open');
      document.body.style.top = '';
      
      // Restore scroll position
      if (scrollY) {
        window.scrollTo(0, parseInt(scrollY || '0') * -1);
      }
      
      modalOverlay.scrollTop = 0;
    }

    async function showFullPost(markdownFile, image, title, objectPosition) {
      try {
        console.log(`Fetching markdown content from ${markdownFile}`);
        const response = await fetch(markdownFile);
        if (!response.ok) {
          console.error(`Markdown fetch failed with status: ${response.status}`);
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        const text = await response.text();
        console.log(`Successfully loaded markdown content (${text.length} characters)`);
        
        // Configure marked.js to handle mermaid code blocks
        const renderer = new marked.Renderer();
        const originalCodeRenderer = renderer.code;
        
        renderer.code = function(code, language) {
          if (language === 'mermaid') {
            const mermaidId = 'mermaid-diagram-' + Math.random().toString(36).substring(2, 10);
            return `<div class="mermaid" id="${mermaidId}">${code}</div>`;
          }
          return originalCodeRenderer.call(this, code, language);
        };
        
        marked.setOptions({ renderer: renderer });
        
        const html = marked.parse(text);
        
        // Create content with image at the top
        let modalContent = '';
        
        // Add the image if available
        if (image) {
          console.log(`Adding image to modal: ${image}`);
          // Use custom objectPosition if provided, otherwise use default (center 35%)
          // Using direct style attribute with !important to ensure it overrides the CSS
          const positionValue = objectPosition || 'center 35%';
          const positionStyle = objectPosition ? `style="object-position: ${objectPosition} !important;"` : '';
          
          // Position indicator for easy reference (only in development mode)
          const positionIndicator = window.debugMode ? 
            `<div style="position: absolute; top: 10px; right: 60px; background: rgba(0,0,0,0.6); color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-family: monospace;">
              Position: ${positionValue}
            </div>` : '';
          
          modalContent += `
            <div style="position: relative;">
              <img src="${image}" alt="${title}" class="modal-article-image" ${positionStyle} onerror="this.src='https://via.placeholder.com/800x400?text=Image+Not+Found'; console.error('Failed to load image: ${image}');">
              ${positionIndicator}
            </div>
          `;
        }
        
        // Add the parsed markdown content
        modalContent += html;
        
        modalBody.innerHTML = modalContent;
        
        // Show modal
        modalOverlay.style.display = 'block';
        
        // Force height recalculation on mobile
        if (isMobile) {
          requestAnimationFrame(() => {
            const bodyHeight = modalBody.scrollHeight;
            modalContent.style.minHeight = (bodyHeight + 120) + 'px';
          });
        }
        
        // Store current scroll position
        const scrollY = window.scrollY;
        
        // Add class to body for mobile fixes
        document.body.classList.add('modal-open');
        document.body.style.top = `-${scrollY}px`;
        
        // Ensure modal starts at top and proper sizing
        setTimeout(() => {
          modalOverlay.scrollTop = 0;
          
          // Force recalculation of heights for mobile
          if (isMobile) {
            modalContent.style.minHeight = modalBody.scrollHeight + 100 + 'px';
          }
          
          // Debug - log modal height
          console.log('Modal overlay height:', modalOverlay.scrollHeight);
          console.log('Modal content height:', modalContent.scrollHeight);
          console.log('Modal body height:', modalBody.scrollHeight);
          console.log('Modal overlay scrollable:', modalOverlay.scrollHeight > modalOverlay.clientHeight);
        }, 100);
        
        // Initialize mermaid diagrams after content is loaded
        if (window.mermaid) {
          try {
          mermaid.initialize({
            startOnLoad: false,
            theme: 'dark',
            securityLevel: 'loose',
            themeCSS: `
              .node rect, .node circle, .node ellipse, .node polygon, .node path {
                fill: #000000;
                stroke: rgba(79, 70, 229, 0.7);
              }
              .edgePath .path {
                stroke: rgba(79, 70, 229, 0.7);
              }
              .label {
                color: #000000 !important;
              }
              .label foreignObject {
                overflow: visible;
              }
              .nodeLabel {
                color: #000000 !important;
                font-weight: 600;
              }
              .node text {
                fill: #000000 !important;
              }
              .node foreignObject div {
                color: #000000 !important;
              }
            `
          });
          
          mermaid.run({
            querySelector: '.mermaid'
          });
          
            console.log('Mermaid diagrams initialized');
          } catch (mermaidErr) {
            console.error('Error initializing mermaid:', mermaidErr);
          }
        } else {
          // Load mermaid if needed and there are diagrams
          const hasMermaidDiagrams = modalBody.querySelector('.mermaid');
          if (hasMermaidDiagrams) {
            window.loadMermaid();
            window.pendingMermaidInit = function() {
              try {
                mermaid.initialize({
                  startOnLoad: false,
                  theme: 'dark',
                  securityLevel: 'loose',
                  themeCSS: `
                    .node rect, .node circle, .node ellipse, .node polygon, .node path {
                      fill: #000000;
                      stroke: rgba(79, 70, 229, 0.7);
                    }
                    .edgePath .path {
                      stroke: rgba(79, 70, 229, 0.7);
                    }
                    .label {
                      color: #000000 !important;
                    }
                    .label foreignObject {
                      overflow: visible;
                    }
                    .nodeLabel {
                      color: #000000 !important;
                      font-weight: 600;
                    }
                    .node text {
                      fill: #000000 !important;
                    }
                    .node foreignObject div {
                      color: #000000 !important;
                    }
                  `
                });
                mermaid.run({
                  querySelector: '.mermaid'
                });
                console.log('Mermaid diagrams initialized');
              } catch (mermaidErr) {
                console.error('Error initializing mermaid:', mermaidErr);
              }
            };
          }
        }
        
        // Ensure focus is trapped in the modal for accessibility
        modalClose.focus();
      } catch (error) {
        console.error('Error fetching markdown:', error);
        modalBody.innerHTML = `
          <div style="padding: 20px; background: rgba(225, 29, 72, 0.1); border: 1px solid rgba(225, 29, 72, 0.3); border-radius: 8px; margin-bottom: 20px;">
            <h2 style="color: #fb7185; margin-bottom: 10px;">Error Loading Article</h2>
            <p>Failed to load the article content. Please try again later.</p>
            <p><strong>Technical details:</strong> ${error.message}</p>
            <p><strong>Attempted to load:</strong> ${markdownFile}</p>
          </div>`;
        modalOverlay.style.display = 'flex';
      }
    }

    // Make contact items clickable
    function setupContactItems() {
      document.querySelectorAll('.contact-item').forEach(item => {
        const link = item.querySelector('a');
        if (link) {
          // Add attributes for accessibility
          item.setAttribute('role', 'button');
          item.setAttribute('aria-label', link.textContent.trim());
          item.setAttribute('tabindex', '0');
          
          // Make the entire item clickable
          item.addEventListener('click', (e) => {
            // Only trigger if not clicking on the actual link
            if (!e.target.closest('a')) {
              // If it's an email link, open mail app
              if (link.href.startsWith('mailto:')) {
                window.location.href = link.href;
              } else {
                // Otherwise open in new tab
                window.open(link.href, '_blank');
              }
            }
          });
          
          // Add keyboard navigation
          item.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
              if (!e.target.closest('a')) {
                e.preventDefault();
                if (link.href.startsWith('mailto:')) {
                  window.location.href = link.href;
                } else {
                  window.open(link.href, '_blank');
                }
              }
            }
          });
        }
      });
    }
    
    // Utility function for debugging and adjusting image positions
    window.adjustImagePosition = function(articleIndex, verticalPosition) {
      // Load current posts data with cache busting
      const timestamp = new Date().getTime();
      fetch(`config/articles.json?_=${timestamp}`)
        .then(response => response.json())
        .then(posts => {
          if (posts[articleIndex]) {
            // Update the object position with the new vertical value
            const position = `center ${verticalPosition}%`;
            
            console.log(`Previewing image position: ${position} for article "${posts[articleIndex].title}"`);
            
            // Show a preview by opening the modal with the adjusted position
            showFullPost(
              posts[articleIndex].markdown,
              posts[articleIndex].image,
              posts[articleIndex].title,
              position
            );
            
            // Add debugging info to the modal
            setTimeout(() => {
              const imgElement = document.querySelector('.modal-article-image');
              if (imgElement) {
                const computedStyle = window.getComputedStyle(imgElement);
                const actualPosition = computedStyle.objectPosition;
                
                const debugDiv = document.createElement('div');
                debugDiv.style.background = 'rgba(0,0,0,0.8)';
                debugDiv.style.color = '#fff';
                debugDiv.style.padding = '10px';
                debugDiv.style.marginTop = '10px';
                debugDiv.style.borderRadius = '4px';
                debugDiv.style.fontSize = '12px';
                debugDiv.style.fontFamily = 'monospace';
                debugDiv.innerHTML = `
                  <strong>Image Position Debug:</strong><br>
                  Requested position: ${position}<br>
                  Actual computed position: ${actualPosition}<br>
                  Applied via: ${imgElement.getAttribute('style') ? 'Inline style' : 'CSS class'}<br>
                  Full inline style: ${imgElement.getAttribute('style') || 'none'}
                `;
                
                modalBody.insertBefore(debugDiv, modalBody.firstChild.nextSibling);
              }
            }, 100);
            
            // Log instructions for saving the change
            console.log(`To save this position, update your articles.json file with "objectPosition": "${position}" for article "${posts[articleIndex].title}"`);
          } else {
            console.error(`Article index ${articleIndex} not found. Available indices are 0 to ${posts.length - 1}`);
          }
        })
        .catch(err => console.error('Error loading articles:', err));
    };
  </script>
</body>
</html>